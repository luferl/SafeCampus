<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<title> 平安校园后台管理系统 </title>
		<meta name="description" content="">
		<meta name="author" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<!-- Basic Styles -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.min.css">
		<!-- SmartAdmin Styles : Caution! DO NOT change the order -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production-plugins.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-skins.min.css">
		<!-- SmartAdmin RTL Support  -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-rtl.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/demo.min.css">
		<!-- FAVICONS -->
		<link rel="shortcut icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<link rel="icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<!-- GOOGLE FONT -->
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700">
		<!-- Specifying a Webpage Icon for Web Clip 
			 Ref: https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html -->
		<link rel="apple-touch-icon" href="img/splash/sptouch-icon-iphone.png">
		<link rel="apple-touch-icon" sizes="76x76" href="img/splash/touch-icon-ipad.png">
		<link rel="apple-touch-icon" sizes="120x120" href="img/splash/touch-icon-iphone-retina.png">
		<link rel="apple-touch-icon" sizes="152x152" href="img/splash/touch-icon-ipad-retina.png">
	</head>
	<body class="">
		<!-- HEADER -->
		<header id="header">
			<div id="logo-group">
				<!-- PLACE YOUR LOGO HERE -->
				<span id="logo"> <img src="img/logo.png" alt="SmartAdmin"> </span>		
			</div>
			<!-- pulled right: nav area -->
			<div class="pull-right">
				<!-- collapse menu button -->
				<div id="hide-menu" class="btn-header pull-right">
					<span> <a href="javascript:void(0);" data-action="toggleMenu" title="Collapse Menu"><i class="fa fa-reorder"></i></a> </span>
				</div>
				<!-- end collapse menu -->
				<!-- logout button -->
				<div id="logout" class="btn-header transparent pull-right">
					<span> <a href="login.html" title="Sign Out" data-action="userLogout" data-logout-msg="You can improve your security further after logging out by closing this opened browser"><i class="fa fa-sign-out"></i></a> </span>
				</div>
				<div id="Name" class="btn-header transparent pull-right">
					<span> <a href="#">平安校园管理员</a> </span>
				</div>
				<!-- end logout button -->
			</div>
			<!-- end pulled right: nav area -->
		</header>
		<!-- END HEADER -->
		<!-- Left panel : Navigation area -->
		<aside id="left-panel">
			<!-- NAVIGATION : This navigation is also responsive-->
			<nav>
				<ul>
					<li>
						<a href="index.html" title="Dashboard"><i class="fa fa-lg fa-fw fa-home"></i> <span class="menu-item-parent">首页</span></a>
					</li>
					<li>
						<a href="#"><i class="fa fa-lg fa-fw fa-cog"></i> <span class="menu-item-parent">系统设置</span></a>
						<ul>
							<li>
								<a href="account_manage.html">账号管理</a>
							</li>
							<li>
								<a href="wx_config.html">微信接口设置</a>
							</li>
							<li>
								<a href="import_students.html">导入学生数据</a>
							</li>
						</ul>
					</li>
					<li>
							<a href="course.html"><i class="fa fa-lg fa-fw fa-play"></i> <span class="menu-item-parent">课程设置</span></a>
						</li>
					<li class="active">
						<a href="#"><i class="fa fa-lg fa-fw fa-pencil-square-o"></i> <span class="menu-item-parent">题库设置</span></a>
						<ul>
							<li>
								<a href="knowledge.html">知识点设置</a>
							</li>
							<li class="active">
								<a href="questions.html">题目设置</a>
							</li>
							<li>
									<a href="import_questions.html">题目导入</a>
							</li>
							<li>
								<a href="quizes.html">试卷设置</a>
							</li>
							<li>
								<a href="quizes_d.html">试卷回收站</a>
							</li>
						</ul>
					</li>
			</nav>
			<span class="minifyme" data-action="minifyMenu"> 
				<i class="fa fa-arrow-circle-left hit"></i> 
			</span>

		</aside>
		<!-- END NAVIGATION -->
		<!-- MAIN PANEL -->
		<div id="main" role="main">

			<!-- MAIN CONTENT -->
			<div id="content">

				<div class="row">
					
				</div>
								<!-- widget grid -->
								<section id="widget-grid" class="">

										<!-- row -->
										<div class="row">
												<article class="col-sm-12 col-md-12 col-lg-12">
														<!-- Widget ID (each widget will need unique ID)-->
														<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
															<header>
																<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
																<h2>题目检索</h2>
															</header>
															<!-- widget div-->
															<div>
																<!-- widget content -->
																<form class="smart-form">
																		<fieldset>
																			<div class="row">
																				<section class="col col-md-2">
																					<label class="label">选择知识点:</label>
																					<div class="col-md-6">
																						<select class="form-control" id="searchknowledge">
																							<option value='0'>全部</option>
																						</select>
																					</div>
																				</section>
																				<section class="col col-md-2">
																					<label class="label">选择题型:</label>
																					<div class="col-md-6">
																						<select class="form-control" id="searchtype">
																							<option value="all">全部</option>
																							<option value="single">单选</option>
																							<option value="multy">多选</option>
																							<option value="check">判断</option>
																						</select>
																					</div>
																				</section>
																				<section class="col col-md-2">
																					<label class="label">每页数量:</label>
																					<div class="col-md-6">
																						<select class="form-control" id="pagecount">
																							<option>5</option>
																							<option>10</option>
																							<option>20</option>
																							<option>30</option>
																						    <option>40</option>
																							<option>50</option>
																						</select>
																					</div>
																				</section>
																				<section class="col col-md-6">
																					<label class="label">查找:</label>
																						<div class="row">
																							<a class="btn btn-primary btn-sm" href="javascript:searchquestions();"><i class="fa fa-search"></i>进行检索</a>
																						</div>
																				</section>
																			</div>
																		</fieldset>
																		<fieldset>
																			<div class="row">
																				<section class="col col-md-6">
																					<label class="label">查询结果:</label-->
																					<div class="row">
																						<a class="btn btn-default disabled btn-sm" href="javascript:void(0);" id="currentpageNpages">第1/1页</a>
																						<a class="btn btn-primary btn-sm" href="javascript:prepage();"><i class="fa fa-toggle-left"></i>上一页</a>
																						&nbsp;跳转第<input style="width:20px;height:20px;padding-bottom:3px" type="text" value="1" id="jumppages">页&nbsp;
																						<a class="btn btn-primary btn-sm" href="javascript:jumppage();"><i class="fa fa-search"></i>跳转</a>
																						<a class="btn btn-primary btn-sm" href="javascript:nextpage();"><i class="fa fa-toggle-right"></i>下一页</a>
																					</div>
																				</section>
																				<section class="col col-md-6">
																					<label class="label">操作:</label-->
																					<div class="row">
																						<a class="btn btn-primary btn-sm" href="javascript:addquestion();"><i class="fa fa-plus-circle"></i>添加</a>
																						<a class="btn btn-primary btn-sm" href="javascript:save();"><i class="fa fa-save"></i>保存</a>
																						<a class="btn btn-primary btn-sm" href="javascript:loadquestions();">取消</a>
																					</div>
																				</section>
																			</div>
																		</fieldset>
																	</form>
																<!-- end widget content -->
											
															</div>
															<!-- end widget div -->
											
														</div>
														<!-- end widget -->
											
													</article>
												<article class="col-sm-12 col-md-12 col-lg-12">
														<!-- Widget ID (each widget will need unique ID)-->
														<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
															<header>
																<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
																<h2>题目列表</h2>
															</header>
															<!-- widget div-->
															<div>						
																<!-- widget content -->
																<form class="smart-form" id="questionlist">
																</form>
																<!-- end widget content -->
															</div>
															<!-- end widget div -->
														</div>
														<!-- end widget -->
													</article>
										</div>
					
										<!-- end row -->					
									</section>
									<!-- end widget grid -->
			</div>
			<!-- END MAIN CONTENT -->

		</div>
		<!-- END MAIN PANEL -->

		<!-- PAGE FOOTER -->
		<div class="page-footer">
			<div class="row">
				<div class="col-xs-12 col-sm-6">
					<span class="txt-color-white">平安校园后台管理系统</span>
				</div>
			</div>
		</div>
		<!-- END PAGE FOOTER -->
		<script data-pace-options='{ "restartOnRequestAfter": true }' src="js/plugin/pace/pace.min.js"></script>
	    <script src="js/libs/jquery-2.1.1.min.js"></script>
	    <script src="js/libs/jquery-ui-1.10.3.min.js"></script>
		<script src="js/app.config.js"></script>
		<script src="js/plugin/jquery-touch/jquery.ui.touch-punch.min.js"></script> 
		<script src="js/bootstrap/bootstrap.min.js"></script>
		<script src="js/app.min.js"></script>
		<script type="text/javascript">
		var knowledgelist;
		$.ajax({  
	          type:"POST", 
	          url:"GetKnowledge", 
	          dataType:"json", 
	          async : false,
   			  success:function(data){   //function1()
   				knowledgelist=data;
   				for(i=0;i<data.length;i++)
				{
					//count++;
					$("#searchknowledge").append("<option value='"+data[i].id+"'>"+data[i].text+"</option>");
				}
	        }
	  	});
		var knowledgeid=$("#searchknowledge").val();
		var questiontype=$("#searchtype").val();
		var pagecount=$("#pagecount").val();
		var pages=1;
		var allpages=0;
		var addid=-1;
		function loadquestions()
		{
			$("#questionlist").empty();
			$.post("GetQuestions",{
				knowledgeid:knowledgeid,
				questiontype:questiontype,
				pagecount:pagecount,
				pages:pages
				},
				function(data){
					var html="";
					var opt="";
					var counts=data.counts;
					if(counts%pagecount==0)
						counts--;
					allpages=(parseInt(counts/pagecount)+1);
					$("#currentpageNpages").text("第"+pages+"/"+allpages+"页"); // 只支持修改文本
					var questions=data.questions;
					for(i=0;i<questions.length;i++)
					{
						var question = document.createElement('fieldset'); //创建元素
						question.id=questions[i].id;
						var id=questions[i].id;
						var text=questions[i].text;
						var choices=questions[i].choices;
						var type=questions[i].type;
						var knowledgeid=questions[i].knowledgeid;
						var knowledgetext="";
						for(j=0;j<knowledgelist.length;j++)
						{
							if(knowledgeid==knowledgelist[j].id)
								knowledgetext=knowledgelist[j].text;
						}
						var answer=questions[i].answer;
						var html="<div class='row'><section class='col col-md-2'><label class='label'>知识点:</label><div class='col-md-6'><select class='form-control' id='KnowSelect"+id+"'><option value='"+knowledgeid+"'>"+knowledgetext+"</option></select></div></section>";
						if(type=="check")
							{
							html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'>单选</option><option value='multy'>多选</option><option value='check' selected='selected'>判断</option></select></div></section></div>";
							}
						else
							if(type=="single")
								{
									html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'  selected='selected'>单选</option><option value='multy'>多选</option><option value='check'>判断</option></select></div></section></div>";
								}
							else
								html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'>单选</option><option value='multy'  selected='selected'>多选</option><option value='check'>判断</option></select></div></section></div>";
						html=html+"<section><label class='label'>题干：</label><label class='textarea'> <i class='icon-append fa fa-comment'></i><textarea rows='4' name='comment'>"+text+"</textarea></label></section>";
						if(type=="check")
							{
								if(answer=="0")
									html=html+"<section class='checkchoice'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
								else
									html=html+"<section class='checkchoice'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle' checked='checked'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
							}
						else
						{
							html=html+"<section class='checkchoice' style='display:none'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle' checked='checked'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
						}
						if(type=="single")
							html=html+"<section class='singlechoice'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
						else
							html=html+"<section class='singlechoice' style='display:none'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
						var optarr=choices.split('|');
						opt="";
						for(j=0;j<optarr.length;j++)
						{
							if(answer.indexOf(String.fromCharCode(65+j)) != -1)
								opt=opt+"<div class=‘row’><label class='radio col col-2'><input type='radio' name='single"+id+"' checked='checked'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
							else
								opt=opt+"<div class=‘row’><label class='radio col col-2'><input type='radio' name='single"+id+"'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
						}
						html=html+opt;
						html=html+"</div></div></section>";
						if(type=="multy")
							html=html+"<section class='multychoice'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
						else
							html=html+"<section class='multychoice' style='display:none'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
						opt="";
						for(j=0;j<optarr.length;j++)
						{
							if(answer.indexOf(String.fromCharCode(65+j)) != -1)
								opt=opt+"<div class=‘row’><label class='checkbox col col-2'><input type='checkbox' name='multy"+id+"' checked='checked'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
							else
								opt=opt+"<div class=‘row’><label class='checkbox col col-2'><input type='checkbox' name='multy"+id+"'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
						}
						html=html+opt;
						html=html+"</div></div></section>";
						question.innerHTML=html;
						var field = document.getElementById('questionlist'); //2、找到父级元素
						field.appendChild(question);//插入到最左边
						for(j=0;j<knowledgelist.length;j++)
						{
							if(knowledgelist[j].id!=knowledgeid)
							{
								$("#KnowSelect"+id).append("<option value='"+knowledgelist[j].id+"'>"+knowledgelist[j].text+"</option>");
							}
						}
					}
					addtrigger();
				}
			);
		}
		loadquestions();
		function prepage()
		{
			if(pages>1)
				{
					pages--;
					loadquestions();
				}
				
		}
		function nextpage()
		{
			if(pages<allpages)
				{
					pages++;
					loadquestions();
				}
		}
		function jumppage()
		{
			var jp=$("#jumppages").val();
			if(jp>0&&jp<=allpages)
				{
					pages=jp;
					loadquestions();
				}
		}
		function searchquestions()
		{
			knowledgeid=$("#searchknowledge").val();
			questiontype=$("#searchtype").val();
			pagecount=$("#pagecount").val();
			pages=1;
			allpages=0;
			loadquestions();
		}
		function addquestion()
		{
			var question = document.createElement('fieldset'); //创建元素
			question.id=addid;
			var id=addid;
			addid--;
			var text="";
			var choices="A、|B、|C、|D、";
			var type="check";
			var knowledgeid=0;
			var knowledgetext="全部";
			var knowledgeoption=""
			var html="<div class='row'><section class='col col-md-2'><label class='label'>知识点:</label><div class='col-md-6'><select class='form-control' id='KnowSelect"+id+"'><option value='0'>全部</option>";
			for(j=0;j<knowledgelist.length;j++)
			{
				html=html+"<option value='"+knowledgelist[j].id+"'>"+knowledgelist[j].text+"</option>"
			}
			html=html+"</select></div></section>";
			var answer="0";
			if(type=="check")
				{
				html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'>单选</option><option value='multy'>多选</option><option value='check' selected='selected'>判断</option></select></div></section></div>";
				}
			else
				if(type=="single")
					{
						html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'  selected='selected'>单选</option><option value='multy'>多选</option><option value='check'>判断</option></select></div></section></div>";
					}
				else
					html=html+"<section class='col col-md-2'><label class='label'>题型:</label><div class='col-md-6'><select class='form-control typeselect'><option value='single'>单选</option><option value='multy'  selected='selected'>多选</option><option value='check'>判断</option></select></div></section></div>";
			html=html+"<section><label class='label'>题干：</label><label class='textarea'> <i class='icon-append fa fa-comment'></i><textarea rows='4' name='comment'>"+text+"</textarea></label></section>";
			if(type=="check")
				{
					if(answer=="0")
						html=html+"<section class='checkchoice'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
					else
						html=html+"<section class='checkchoice'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle' checked='checked'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
				}
			else
			{
				html=html+"<section class='checkchoice' style='display:none'><label class='label'>答案：</label><div class='row'><div class='col col-4'><label class='toggle'><input type='checkbox' name='checkbox-toggle' checked='checked'><i data-swchon-text='正确' data-swchoff-text='错误'></i>正误：</label></div></div></section>";
			}
			if(type=="single")
				html=html+"<section class='singlechoice'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
			else
				html=html+"<section class='singlechoice' style='display:none'><label class='label'>选项：</label><div class='col col-6'>";
			var optarr=choices.split('|');
			opt="";
			for(j=0;j<optarr.length;j++)
			{
				if(answer.indexOf(String.fromCharCode(65+j)) != -1)
					opt=opt+"<div class=‘row’><label class='radio col col-2'><input type='radio' name='single"+id+"' checked='checked'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
				else
					opt=opt+"<div class=‘row’><label class='radio col col-2'><input type='radio' name='single"+id+"'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
			}
			html=html+opt;
			html=html+"</div></div></section>";
			if(type=="multy")
				html=html+"<section class='multychoice'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
			else
				html=html+"<section class='multychoice' style='display:none'><label class='label'>选项：</label><div class='row'><div class='col col-4'>";
			opt="";
			for(j=0;j<optarr.length;j++)
			{
				if(answer.indexOf(String.fromCharCode(65+j)) != -1)
					opt=opt+"<div class=‘row’><label class='checkbox col col-2'><input type='checkbox' name='multy"+id+"' checked='checked'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
				else
					opt=opt+"<div class=‘row’><label class='checkbox col col-2'><input type='checkbox' name='multy"+id+"'><i></i></label><section class='col col-10'><label class='input'><input type='text' name='"+String.fromCharCode(65+j)+"' value='"+optarr[j]+"'></label></section></div>";
			}
			html=html+opt;
			html=html+"</div></div></section>";
			question.innerHTML=html;
			var field = document.getElementById('questionlist'); //2、找到父级元素
			field.prepend(question);//插入到最前边
			addtrigger();
		}
		function addtrigger()
		{
			$(".typeselect").change(function(){  
				var choice=$(this).find('option:selected').val();
				var fieldset=$(this).parent().parent().parent().parent();
				var singlesection=fieldset.find(".singlechoice");
				var multysection=fieldset.find(".multychoice");
				var checksection=fieldset.find(".checkchoice");
				if(choice=="check")
				{
					singlesection[0].style.display="none";
					multysection[0].style.display="none";
					checksection[0].style.display="";
				}
				else
					if(choice=="single")
					{
						singlesection[0].style.display="";
						multysection[0].style.display="none";
						checksection[0].style.display="none";
					}
				else
					{
						singlesection[0].style.display="none";
						multysection[0].style.display="";
						checksection[0].style.display="none";
					}
			});
		}
		function save()
		{
			var fieldlist=$("#questionlist").find("fieldset");
			var json="[";
			//console.log(fieldlist);
			for(i=0;i<fieldlist.length;i++)
				{
					if(i>0)
						json=json+",";
					var field=fieldlist[i];
					var knowledgeid=field.childNodes[0].childNodes[0].childNodes[1].childNodes[0].value;//知识点，题型
					var type=field.childNodes[0].childNodes[1].childNodes[1].childNodes[0].value;
					var text=field.childNodes[1].childNodes[1].childNodes[2].value; //题干
					var choices="A、|B、|C、|D、";
					var answer="";
					if(type=="check")
					{
						ischeck=field.childNodes[2].childNodes[1].childNodes[0].childNodes[0].childNodes[0].checked;
						if(ischeck)
							answer="1";
						else
							answer="0";
					}
					else
						if(type=="single")
							{
								var choiceA=field.childNodes[3].childNodes[1].childNodes[0].childNodes[0].childNodes[1].childNodes[0].childNodes[0].value;
								var choiceB=field.childNodes[3].childNodes[1].childNodes[0].childNodes[1].childNodes[1].childNodes[0].childNodes[0].value;
								var choiceC=field.childNodes[3].childNodes[1].childNodes[0].childNodes[2].childNodes[1].childNodes[0].childNodes[0].value;
								var choiceD=field.childNodes[3].childNodes[1].childNodes[0].childNodes[3].childNodes[1].childNodes[0].childNodes[0].value;
								choices=choiceA+"|"+choiceB+"|"+choiceC+"|"+choiceD;
								//var answer=field.childNodes[3].find('option:selected').val();
								if(field.childNodes[3].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].checked)
									answer="A";
								else
									if(field.childNodes[3].childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0].checked)
										answer="B";
									else
										if(field.childNodes[3].childNodes[1].childNodes[0].childNodes[2].childNodes[0].childNodes[0].checked)
											answer="C";
										else
											answer="D";
							}
					else
						{
							var choiceA=field.childNodes[4].childNodes[1].childNodes[0].childNodes[0].childNodes[1].childNodes[0].childNodes[0].value;
							var choiceB=field.childNodes[4].childNodes[1].childNodes[0].childNodes[1].childNodes[1].childNodes[0].childNodes[0].value;
							var choiceC=field.childNodes[4].childNodes[1].childNodes[0].childNodes[2].childNodes[1].childNodes[0].childNodes[0].value;
							var choiceD=field.childNodes[4].childNodes[1].childNodes[0].childNodes[3].childNodes[1].childNodes[0].childNodes[0].value;
							choices=choiceA+"|"+choiceB+"|"+choiceC+"|"+choiceD;
							if(field.childNodes[4].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].checked)
								answer=answer+"A";
							if(field.childNodes[4].childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0].checked)
								answer=answer+"B";
							if(field.childNodes[4].childNodes[1].childNodes[0].childNodes[2].childNodes[0].childNodes[0].checked)
								answer=answer+"C";
							if(field.childNodes[4].childNodes[1].childNodes[0].childNodes[3].childNodes[0].childNodes[0].checked)
								answer=answer+"D";
						}
					var id=field.id;
					json=json+"{\"id\":"+id+",\"text\":\""+text+"\",\"type\":\""+type+"\",\"choices\":\""+choices+"\",\"answer\":\""+answer+"\",\"knowledgeid\":\""+knowledgeid+"\"}";
				}
			json=json+"]";
			//console.log(json);
			$.post("SaveQuestions",{
					questions:json
				},
				function(data){
					if(data=="success")
					{
						alert("保存成功！");
						location.reload();
					}
						
				}
			);
		}
		</script>
	</body>

</html>