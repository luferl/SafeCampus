<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<title> 平安校园后台管理系统 </title>
		<meta name="description" content="">
		<meta name="author" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<!-- Basic Styles -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
		<link href="css/bootstrap.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.min.css">
		<!-- SmartAdmin Styles : Caution! DO NOT change the order -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production-plugins.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-skins.min.css">
		<!-- SmartAdmin RTL Support  -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-rtl.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/demo.min.css">
		<!-- FAVICONS -->
		<link rel="shortcut icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<link rel="icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<!-- GOOGLE FONT -->
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700">
		<!-- Specifying a Webpage Icon for Web Clip 
			 Ref: https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html -->
		<link rel="apple-touch-icon" href="img/splash/sptouch-icon-iphone.png">
		<link rel="apple-touch-icon" sizes="76x76" href="img/splash/touch-icon-ipad.png">
		<link rel="apple-touch-icon" sizes="120x120" href="img/splash/touch-icon-iphone-retina.png">
		<link rel="apple-touch-icon" sizes="152x152" href="img/splash/touch-icon-ipad-retina.png">
	</head>
	<body class="">
		<!-- HEADER -->
		<header id="header">
			<div id="logo-group">
				<!-- PLACE YOUR LOGO HERE -->
				<span id="logo"> <img src="img/logo.png" alt="SmartAdmin"> </span>		
			</div>
			<!-- pulled right: nav area -->
			<div class="pull-right">
				<!-- collapse menu button -->
				<div id="hide-menu" class="btn-header pull-right">
					<span> <a href="javascript:void(0);" data-action="toggleMenu" title="Collapse Menu"><i class="fa fa-reorder"></i></a> </span>
				</div>
				<!-- end collapse menu -->
				<!-- logout button -->
				<div id="logout" class="btn-header transparent pull-right">
					<span> <a href="login.html" title="Sign Out" data-action="userLogout" data-logout-msg="You can improve your security further after logging out by closing this opened browser"><i class="fa fa-sign-out"></i></a> </span>
				</div>
				<div id="Name" class="btn-header transparent pull-right">
					<span> <a href="#">平安校园管理员</a> </span>
				</div>
				<!-- end logout button -->
			</div>
			<!-- end pulled right: nav area -->
		</header>
		<!-- END HEADER -->
		<!-- Left panel : Navigation area -->
		<aside id="left-panel">
			<!-- NAVIGATION : This navigation is also responsive-->
			<nav>
				<ul>
					<li>
						<a href="index.html" title="Dashboard"><i class="fa fa-lg fa-fw fa-home"></i> <span class="menu-item-parent">首页</span></a>
					</li>
					<li>
						<a href="#"><i class="fa fa-lg fa-fw fa-cog"></i> <span class="menu-item-parent">系统设置</span></a>
						<ul>
							<li>
								<a href="account_manage.html">账号管理</a>
							</li>
							<li>
								<a href="wx_config.html">微信接口设置</a>
							</li>
							<li>
								<a href="import_students.html">导入学生数据</a>
							</li>
						</ul>
					</li>
					<li class="active">
							<a href="course.html"><i class="fa fa-lg fa-fw fa-play"></i> <span class="menu-item-parent">课程设置</span></a>
						</li>
					<li>
						<a href="#"><i class="fa fa-lg fa-fw fa-pencil-square-o"></i> <span class="menu-item-parent">题库设置</span></a>
						<ul>
							<li>
								<a href="knowledge.html">知识点设置</a>
							</li>
							<li>
								<a href="questions.html">题目设置</a>
							</li>
							<li>
									<a href="import_questions.html">题目导入</a>
							</li>
							<li>
								<a href="quizes.html">试卷设置</a>
							</li>
							<li>
								<a href="quizes_d.html">试卷回收站</a>
							</li>
						</ul>
					</li>
			</nav>
			<span class="minifyme" data-action="minifyMenu"> 
				<i class="fa fa-arrow-circle-left hit"></i> 
			</span>

		</aside>
		<!-- END NAVIGATION -->
		<!-- MAIN PANEL -->
		<div id="main" role="main">
			<!-- MAIN CONTENT -->
			<div id="content">
				<!-- NEW WIDGET START -->
				<article class="col-sm-12 col-md-12 col-lg-2">
					<!-- Widget ID (each widget will need unique ID)-->
					<div class="jarviswidget jarviswidget-color-blue" id="wid-id-1" data-widget-editbutton="false">
						<header>
							<span class="widget-icon"> <i class="fa fa-sitemap"></i> </span>
							<h2>目录列表</h2>
						</header>
						<!-- widget div-->
						<div class="col-sm-6 col-lg-4">
							<div id="tree"></div>
						</div>	
						<!-- end widget div -->
					</div>
					<!-- end widget -->
				</article>	
					
					<article class="col-sm-12 col-md-12 col-lg-5">
							<!-- Widget ID (each widget will need unique ID)-->
							<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
								<header>
									<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
									<h2>课程设置</h2>
								</header>
								<!-- widget div-->
								<div>						
									<!-- widget content -->
									<div class="widget-body">
										<form class="form-horizontal">
											<fieldset>	
											<div class="form-group">
													<label class="control-label col-md-3">类别</label>
														<div class="col-md-5">
															<select class="form-control" id="directtype" onchange="changedirecttype()">
																<option value="direct">目录</option>
																<option value="course">课程</option>
															</select>
														</div>
												</div>
												<div class="form-group">
														<label class="col-md-3 control-label">名称</label>
															<div class="col-md-5">
																<input class="form-control" placeholder="" type="text" id="directname">
															</div>
												</div>
												<div class="form-group">
													<label class="control-label col-md-3">选择所属目录</label>
														<div class="col-md-5">
															<select class="form-control" id="directlist">
																<option value="1">根目录</option>
															</select>
														</div>
												</div>
												<div class="form-group">
														<label class="col-md-3 control-label">视频URL</label>
															<div class="col-md-5">
																<input class="form-control" placeholder="" type="text" id="directurl" disabled="disabled" >
															</div>
												</div>
												<div class="form-group">
														<label class="col-md-3 control-label">视频时长</label>
															<div class="col-md-5">
																<input class="form-control" placeholder="" type="text" id="directtime" disabled="disabled" >
															</div>
												</div>
												<input type="hidden" id="dircetid" value="1" />
											</fieldset>
											<div class="form-actions">
												<div class="row">
													<div class="col-md-12">
														<button class="btn btn-default" type="button" onclick="createnewdirect()">
																创建新课程/目录
														</button>
														<button class="btn btn-primary" type="button" onclick="savedirect()">
																<i class="fa fa-save"></i>
																保存修改
															</button>
														<button class="btn btn-primary" type="button" onclick="deletedirect()">
																<i class="fa fa-save"></i>
																删除课程/目录
															</button>
													</div>
												</div>
											</div>
										</form>
									</div>
									<!-- end widget content -->
								</div>
								<!-- end widget div -->
							</div>
							<!-- end widget -->
						</article>
						<article class="col-sm-12 col-md-12 col-lg-5 pull-right">
								<!-- Widget ID (each widget will need unique ID)-->
								<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
									<header>
										<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
										<h2>视频预览</h2>
									</header>
									<!-- widget div-->
									<div>						
										<!-- widget content -->
										<div class="widget-body">
											<form class="form-horizontal">
												<fieldset>
													<iframe style=" z-index:1; " src="" allowfullscreen="" frameborder="0" height="400" width="100%" id="videopreview"></iframe>
												
												</fieldset>
											
											</form>
										</div>
										<!-- end widget content -->
									</div>
									<!-- end widget div -->
								</div>
								<!-- end widget -->
							</article>
							<article class="col-sm-12 col-md-12 col-lg-10 pull-right">
								<!-- Widget ID (each widget will need unique ID)-->
								<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
									<header>
										<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
										<h2>课后题</h2>
									</header>
									<!-- widget div-->
									<div>						
										<!-- widget content -->
										<fieldset>
										<div class="widget-body">
												<div class="col-md-12">
														<table class="table table-bordered" id="fieldsTable">
															<thead>
															<tr>
																<th style="width:4%" name="name">题号</th>
																<th style="width:6%"name="type">题目类型</th>
																<th style="width:39%"name="details">题干</th>
																<th style="width:39%"name="details">选项</th>
																<th style="width:6%"name="details">正确答案</th>
																<th style="width:6%">操作</th>
															</tr>
															</thead>
															<tbody id="fieldsTableBody">
															</tbody>
														</table>															
													</div>
										</div>
									</fieldset>
										<div class="form-actions">
												<div class="row">
													<div class="col-md-12">
														<button class="btn btn-default"  type="button" onclick=addOneRow();>
																	添加题型
														</button>
														<button class="btn btn-default" type="submit">
															取消
														</button>
														<button class="btn btn-primary" type="submit">
															<i class="fa fa-save"></i>
															保存修改
														</button>
													</div>
												</div>
											</div>
											<!-- end widget content -->
										</div>
										<!-- end widget content -->
									</div>
									<!-- end widget div -->
								</div>
								<!-- end widget -->
							</article>
							<article class="col-sm-12 col-md-12 col-lg-10 pull-right">
									<!-- Widget ID (each widget will need unique ID)-->
									<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
										<header>
											<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
											<h2>课后题</h2>
										</header>
										<!-- widget div-->
										<div>						
											<!-- widget content -->
											<fieldset>
											<div class="widget-body">
													<div class="col-md-12">
															<table class="table table-bordered" id="fieldsTable">
																<thead>
																<tr>
																	<th style="width:4%" name="name">题号</th>
																	<th style="width:6%"name="type">题目类型</th>
																	<th style="width:39%"name="details">题干</th>
																	<th style="width:39%"name="details">选项</th>
																	<th style="width:6%"name="details">正确答案</th>
																	<th style="width:6%">操作</th>
																</tr>
																</thead>
																<tbody id="fieldsTableBody">
																</tbody>
															</table>															
														</div>
											</div>
										</fieldset>
											<div class="form-actions">
													<div class="row">
														<div class="col-md-12">
															<button class="btn btn-default"  type="button" onclick=addOneRow();>
																		添加题型
															</button>
															<button class="btn btn-default" type="submit">
																取消
															</button>
															<button class="btn btn-primary" type="submit">
																<i class="fa fa-save"></i>
																保存修改
															</button>
														</div>
													</div>
												</div>
												<!-- end widget content -->
											</div>
											<!-- end widget content -->
										</div>
										<!-- end widget div -->
									</div>
									<!-- end widget -->
								</article>
			</div>
			<!-- END MAIN CONTENT -->
		</div>
		<!-- END MAIN PANEL -->
		<script data-pace-options='{ "restartOnRequestAfter": true }' src="js/plugin/pace/pace.min.js"></script>
	    <script src="js/libs/jquery-2.1.1.min.js"></script>
	    <script src="js/libs/jquery-ui-1.10.3.min.js"></script>
		<script src="js/app.config.js"></script>
		<script src="js/plugin/jquery-touch/jquery.ui.touch-punch.min.js"></script> 
		<script src="js/bootstrap/bootstrap.min.js"></script>
		<script src="js/app.min.js"></script>
		<script src="js/bootstrap-treeview.js"></script>
		<script type="text/javascript">
		// DO NOT REMOVE : GLOBAL FUNCTIONS!
			$(document).ready(function() {
				pageSetUp();
				// PAGE RELATED SCRIPTS
				$.get("GetDirectories",
							function(data){
								$('#tree').treeview({
									data: data,
									onNodeSelected: function(event, node) {
										changedirect(node);
									}
								});
							}
						);	
			});
		var id=0;
		function addOneRow()
		{
			var tableBody = document.getElementById("fieldsTableBody");
			var row = tableBody.appendChild(document.createElement("tr"));
			row.setAttribute("id", id++);
			var td = new Array();
			td[0] = row.appendChild(document.createElement("td")).appendChild(document.createElement("text"));
			td[1] = row.appendChild(document.createElement("td")).appendChild(document.createElement("select"));
			td[2] = row.appendChild(document.createElement("td")).appendChild(document.createElement("input"));
			td[3] = row.appendChild(document.createElement("td")).appendChild(document.createElement("input"));
			td[4] = row.appendChild(document.createElement("td")).appendChild(document.createElement("input"));
			td[5] = row.appendChild(document.createElement("td")).appendChild(document.createElement("button"));
			td[0].outerHTML = '<P>1</p>';
			td[1].outerHTML = '<select onchange="changetype(this)"><option value="TF">判断题</option>      <option value="Single">单选题</option>      <option value="Multy">多选题</option></select>';
			td[2].outerHTML = '<textarea rows="3" cols="60%">';
			td[3].outerHTML = '<textarea rows="3" cols="60%" disabled="true">';
			td[4].outerHTML = '<input type="textarea" style="width:98%;">';
			td[5].outerHTML = '<button onclick="delOne(this)">删除</button>';
		};
		function delOne(x)
		{
			row.parentNode.removeChild(row);
			--id;
		}
		function changetype(x)
		{
			var row = x.parentNode.parentNode;
			console.log(row.cells[1]);
			//if(row.cell[1].innerHTML)
			row.cells[3].innerHTML='<textarea rows="3" cols="60%">';
			//row.cells[3].innerHTML='<textarea rows="3" cols="60%" disabled="flase">';
		}
		function changedirect(node)
		{
			console.log(node.id);
			iscourse=node.iscourse;
			$('#dircetid').val(node.id);
			$('#directname').val(node.text);
			$("#directlist").val(node.topid); 
			if(iscourse==0)
			{
				$("#directtype").val("direct");
				$('#directurl').val("");
				$('#directtime').val("");
				$('#directurl').attr("disabled","disabled");
				$('#directtime').attr("disabled","disabled");
				document.getElementById("videopreview").src ="";
			}
			else
			{
				$("#directtype").val("course");
				$('#directurl').removeAttr("disabled");
				$('#directtime').removeAttr("disabled");
				$('#directurl').val(node.url);
				$('#directtime').val(node.time);
				var temp=node.url.split('/');
				temp=temp[temp.length-1];
				temp=temp.split('.')[0];
				temp="http://v.qq.com/iframe/player.html?vid="+temp+"&tiny=0&auto=0";
				document.getElementById("videopreview").src =temp;
			}
		}
		$.get("GetDirectlist",
				function(data){
					for(i=0;i<data.length;i++)
					{
						obj=data[i];
						document.getElementById("directlist").options.add(new Option(obj.text,obj.id));
					}
				}
			);	
		function changedirecttype(x)
		{
			if($("#directtype").val()=="direct")
			{
				$('#directurl').val("");
				$('#directtime').val("");
				$('#directurl').attr("disabled","disabled");
				$('#directtime').attr("disabled","disabled");
			}
			else
				{
					$('#directurl').removeAttr("disabled");
					$('#directtime').removeAttr("disabled");
					$('#directurl').val(node.url);
					$('#directtime').val(node.time);
				}
		}
		function createnewdirect()
		{
			var name=$('#directname').val();
			var topid=$('#directlist').val();
			var type;
			if($('#directtype').val()=="direct")
				type=0;
			else
				type=1;
			var vurl=$('#directurl').val();
			var vtime=$('#directtime').val();
			$.post("CreateDirect",
					{
						text:name,
						topid:topid,
						iscourse:type,
						vurl:vurl,
						time:vtime
					},
					function(data){
						if(data=="success")
							{
								alert("创建成功");
								location.reload();
							}
						else
							{
								alert(data);
							}
					}
				);	
		}
		function savedirect()
		{
			var name=$('#directname').val();
			var topid=$('#directlist').val();
			var id=$('#dircetid').val();
			console.log(id);
			var type;
			if($('#directtype').val()=="direct")
				type=0;
			else
				type=1;
			var vurl=$('#directurl').val();
			var vtime=$('#directtime').val();
			$.post("SaveDirect",
					{
						id:id,
						text:name,
						topid:topid,
						iscourse:type,
						vurl:vurl,
						time:vtime
					},
					function(data){
						if(data=="success")
							{
								alert("修改成功");
								location.reload();
							}
						else
							{
								alert(data);
							}
					}
				);	
		}
		function deletedirect()
		{
			var id=$('#dircetid').val();
			$.post("DeleteDirect",
					{
						id:id
					},
					function(data){
						if(data=="success")
							{
								alert("删除成功");
								location.reload();
							}
						else
							{
								alert(data);
							}
					}
				);	
		}
		</script>
	</body>

</html>