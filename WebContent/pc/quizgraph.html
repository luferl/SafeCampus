<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<title> 平安校园后台管理系统 </title>
		<meta name="description" content="">
		<meta name="author" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<!-- Basic Styles -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.min.css">
		<!-- SmartAdmin Styles : Caution! DO NOT change the order -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production-plugins.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-skins.min.css">
		<!-- SmartAdmin RTL Support  -->
		<link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-rtl.min.css">
		<link rel="stylesheet" type="text/css" media="screen" href="css/demo.min.css">
		<!-- FAVICONS -->
		<link rel="shortcut icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<link rel="icon" href="img/favicon/favicon.ico" type="image/x-icon">
		<!-- GOOGLE FONT -->
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700">
		<!-- Specifying a Webpage Icon for Web Clip 
			 Ref: https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html -->
		<link rel="apple-touch-icon" href="img/splash/sptouch-icon-iphone.png">
		<link rel="apple-touch-icon" sizes="76x76" href="img/splash/touch-icon-ipad.png">
		<link rel="apple-touch-icon" sizes="120x120" href="img/splash/touch-icon-iphone-retina.png">
		<link rel="apple-touch-icon" sizes="152x152" href="img/splash/touch-icon-ipad-retina.png">
	</head>
	<body class="">
		<!-- HEADER -->
		<header id="header">
			<div id="logo-group">
				<!-- PLACE YOUR LOGO HERE -->
				<span id="logo"> <img src="img/logo.png" alt="SmartAdmin"> </span>		
			</div>
			<!-- pulled right: nav area -->
			<div class="pull-right">
				<!-- collapse menu button -->
				<div id="hide-menu" class="btn-header pull-right">
					<span> <a href="javascript:void(0);" data-action="toggleMenu" title="Collapse Menu"><i class="fa fa-reorder"></i></a> </span>
				</div>
				<!-- end collapse menu -->
				<!-- logout button -->
				<div id="logout" class="btn-header transparent pull-right">
					<span> <a href="login.html" title="Sign Out" data-action="userLogout" data-logout-msg="You can improve your security further after logging out by closing this opened browser"><i class="fa fa-sign-out"></i></a> </span>
				</div>
				<div id="Name" class="btn-header transparent pull-right">
					<span> <a href="#">平安校园管理员</a> </span>
				</div>
				<!-- end logout button -->
			</div>
			<!-- end pulled right: nav area -->
		</header>
		<!-- END HEADER -->
		<!-- Left panel : Navigation area -->
		<aside id="left-panel">
			<!-- NAVIGATION : This navigation is also responsive-->
			<nav>
				<ul>
					<li>
						<a href="index.html" title="Dashboard"><i class="fa fa-lg fa-fw fa-home"></i> <span class="menu-item-parent">首页</span></a>
					</li>
					<li>
						<a href="#"><i class="fa fa-lg fa-fw fa-cog"></i> <span class="menu-item-parent">系统设置</span></a>
						<ul>
							<li>
								<a href="account_manage.html">账号管理</a>
							</li>
							<li>
								<a href="wx_config.html">微信接口设置</a>
							</li>
							<li>
								<a href="import_students.html">导入学生数据</a>
							</li>
						</ul>
					</li>
					<li>
							<a href="course.html"><i class="fa fa-lg fa-fw fa-play"></i> <span class="menu-item-parent">课程设置</span></a>
						</li>
					<li class="active">
						<a href="#"><i class="fa fa-lg fa-fw fa-pencil-square-o"></i> <span class="menu-item-parent">题库设置</span></a>
						<ul>
							<li>
								<a href="knowledge.html">知识点设置</a>
							</li>
							<li>
								<a href="questions.html">题目设置</a>
							</li>
							<li>
									<a href="import_questions.html">题目导入</a>
							</li>
							<li class="active">
								<a href="quizes.html">试卷设置</a>
							</li>
							<li>
								<a href="quizes_d.html">试卷回收站</a>
							</li>
						</ul>
					</li>
			</nav>
			<span class="minifyme" data-action="minifyMenu"> 
				<i class="fa fa-arrow-circle-left hit"></i> 
			</span>

		</aside>
		<!-- END NAVIGATION -->
		<!-- MAIN PANEL -->
		<div id="main" role="main">

			<!-- MAIN CONTENT -->
			<div id="content">
				<article class="col-sm-12 col-md-12 col-lg-2">
					<!-- Widget ID (each widget will need unique ID)-->
					<div class="jarviswidget jarviswidget-color-blue" id="wid-id-1" data-widget-editbutton="false">
						<header>
							<span class="widget-icon"> <i class="fa fa-sitemap"></i> </span>
							<h2>试卷列表</h2>
						</header>
						<!-- widget div-->
						<div class="col-sm-6 col-lg-4">
							<div id="tree"></div>
						</div>	
						<!-- end widget div -->
					</div>
					<!-- end widget -->
				</article>	
				<article class="col-sm-12 col-md-12 col-lg-10">
					<!-- Widget ID (each widget will need unique ID)-->
					<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
								<header>
									<span class="widget-icon"> <i class="fa fa-hand-o-up"></i> </span>
									<h2>成绩</h2>
								</header>

								<!-- widget div-->
								<div>

									<!-- widget edit box -->
									<div class="jarviswidget-editbox">
										<!-- This area used as dropdown edit box -->

									</div>
									<!-- end widget edit box -->

									<!-- widget content -->
									<div class="widget-body">
										<p class="alert alert-info">
											在左侧选择试卷，然后可点击下方按钮下载Excel(.xls)格式的相关记录
										</p>

										<p>
											当前选择的试卷为：
											<span id='quizname'>未选择</span>
										</p>
										<input type="hidden" id="quizid" value="-1" />	
										<button class="btn btn-default"  type="button" onclick="DownloadGrades()">下载成绩</button>
										<button class="btn btn-default"  type="button" onclick="DownloadRecords()">下载答题记录</button>
										<button class="btn btn-default" type="button" id="custom_download">自定义下载</button>
									</div>
									<!-- end widget content -->
								</div>
						<!-- end widget div -->
					</div>
					<!-- end widget -->
				</article>
				<article class="col-sm-12 col-md-12 col-lg-10 pull-right">
								<!-- Widget ID (each widget will need unique ID)-->
								<div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">
									<header>
										<span class="widget-icon"> <i class="fa fa-eye"></i> </span>
										<h2>及格率饼图</h2>
									</header>
									<!-- widget div-->
									<div>
									<div class="widget-body">						
									<!-- widget content -->
									<section class="col col-md-4">
										<label style="color:black">选择学院：</label>
										<div class="col-md-10">
											<select class="form-control" id="groupcondition">
												<option value="department">学院</option>
											</select>
										</div>
										<div id="container2" style="min-width:400px;height:400px"></div>
									</section>
									<!-- end widget content -->
									</div>
									</div>
									<!-- end widget div -->
								</div>
								<!-- end widget -->
				</article>
				<article class="col-sm-12 col-md-12 col-lg-10 pull-right">

							<!-- Widget ID (each widget will need unique ID)-->
							<div class="jarviswidget" id="wid-id-2" data-widget-editbutton="false">
								<!-- widget options:
								usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

								data-widget-colorbutton="false"
								data-widget-editbutton="false"
								data-widget-togglebutton="false"
								data-widget-deletebutton="false"
								data-widget-fullscreenbutton="false"
								data-widget-custombutton="false"
								data-widget-collapsed="true"
								data-widget-sortable="false"

								-->
								<header>
									<span class="widget-icon"> <i class="fa fa-bar-chart-o"></i> </span>
									<h2>实时参与人数图</h2>
									
								</header>

								<!-- widget div-->
								<div>
									<!-- widget content -->
									<div class="widget-body no-padding" style="height: 500px">

										<div id="container" style="height: 100%"></div>

									</div>
									<!-- end widget content -->

								</div>
								<!-- end widget div -->

							</div>
							<!-- end widget -->

						</article>
				
				
				
				<div id="dialog_simple" title="选择筛选条件" class="widget-body">
				<form class="smart-form" id="#">
				<fieldset>
					<div class="row">
					<section class="col col-md-4">
						<label style="color:black">学院：</label>
						<div class="col-md-10">
							<select class="form-control" id="collegelist">
								<option value="department">全部</option>
							</select>
						</div>
					</section>
					<section class="col col-md-4">
						<label style="color:black">身份：</label>
						<div class="col-md-10">
							<select class="form-control" id="rolelist">
								<option value="role">全部</option>
							</select>
						</div>
					</section>
					<section class="col col-md-4">
						<label style="color:black">年级：</label>
						<div class="col-md-10">
							<select class="form-control" id="yearlist">
								<option value="year">全部</option>
							</select>
						</div>
					</section>
					<section class="col col-md-4">
						<label style="color:black">成绩：</label>
						<div class="col-md-10">
							<select class="form-control" id="gradestype">
								<option value="all">全部</option>
								<option value="pass">及格</option>
								<option value="unpass">不及格</option>
								<!-->option value="absent">未参加考试</option-->
							</select>
						</div>
					</section>
					</div>
				</fieldset>
				<fieldset>
					<div class="row">
					<section class="col col-md-4">
						<label style="color:black">分组条件：</label>
						<div class="col-md-10">
							<select class="form-control" id="groupcondition">
								<option value="department">学院</option>
								<option value="year">年级</option>
								<option value="role">身份</option>
							</select>
						</div>
					</section>
					</div>
				</fieldset>	
				</div>
			</div>
			<!-- end row -->					
		</section>
		<!-- end widget grid -->
		</div>
		<!-- END MAIN CONTENT -->

		<!-- PAGE FOOTER -->
		<div class="page-footer">
			<div class="row">
				<div class="col-xs-12 col-sm-6">
					<span class="txt-color-white">平安校园后台管理系统</span>
				</div>
			</div>
		</div>
		<!-- END PAGE FOOTER -->
		<script data-pace-options='{ "restartOnRequestAfter": true }' src="js/plugin/pace/pace.min.js"></script>
	    <script src="js/libs/jquery-2.1.1.min.js"></script>
	    <script src="js/libs/jquery-ui-1.10.3.min.js"></script>
		<script src="js/app.config.js"></script>
		<script src="js/plugin/jquery-touch/jquery.ui.touch-punch.min.js"></script> 
		<script src="js/bootstrap/bootstrap.min.js"></script>
		<script src="js/app.min.js"></script>
		<script src="js/plugin/x-editable/moment.min.js"></script>
		<script src="js/plugin/x-editable/jquery.mockjax.min.js"></script>
		<script src="js/plugin/x-editable/x-editable.min.js"></script>
		<script src="js/bootstrap-treeview.js"></script>	
		<script src="https://cdn.hcharts.cn/highcharts/highcharts.js">
		$(function () {
			    $('#container2').highcharts({
			        chart: {
			            plotBackgroundColor: null,
			            plotBorderWidth: null,
			            plotShadow: false
			        },
			        title: {
			            text: '2014 某网站各浏览器浏览量占比'
			        },
			        tooltip: {
			            headerFormat: '{series.name}<br>',
			            pointFormat: '{point.name}: <b>{point.percentage:.1f}%</b>'
			        },
			        plotOptions: {
			            pie: {
			                allowPointSelect: true,
			                cursor: 'pointer',
			                dataLabels: {
			                    enabled: true,
			                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
			                    style: {
			                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
			                    }
			                }
			            }
			        },
			        series: [{
			            type: 'pie',
			            name: '浏览器访问量占比',
			            data: [
			                ['Firefox',   45.0],
			                ['IE',       26.8],
			                {
			                    name: 'Chrome',
			                    y: 12.8,
			                    sliced: true,
			                    selected: true
			                },
			                ['Safari',    8.5],
			                ['Opera',     6.2],
			                ['其他',   0.7]
			            ]
			        }]
			    });
			});
		</script>	
		<script type="text/javascript">
			var id=0;
			var knowledgelist;
			$.get("GetQuizlist",
				function(data){
					$('#tree').treeview({
						data: data,
						onNodeSelected: function(event, node) {
							changechoices(node);
						}
					});
				}
			);
			$.get("GetCollegelist",
					function(data){
						for(i=0;i<data.length;i++)
							$("#collegelist").append("<option value='"+data[i]+"'>"+data[i]+"</option>"); 
					}
				);
			$.get("GetRolelist",
					function(data){
						for(i=0;i<data.length;i++)
							$("#rolelist").append("<option value='"+data[i]+"'>"+data[i]+"</option>"); 
					}
				);
			$.get("GetYearlist",
					function(data){
						for(i=0;i<data.length;i++)
							$("#yearlist").append("<option value='"+data[i]+"'>"+data[i]+"</option>"); 
					}
				);
			function changechoices(node)
			{
				console.log(node.id);
				issimulate=node.issimulate;
				$('#quizid').val(node.id);
				document.getElementById('quizname').innerText=node.text; 
			}
			function DownloadGrades(){
				var id=$('#quizid').val();
				window.location.href="DownloadGrades?id="+id;
			}
			function DownloadRecords(){
				var id=$('#quizid').val();
				window.location.href="DownloadRecords?id="+id;
			}		
			$('#custom_download').click(function() {
				$('#dialog_simple').dialog('open');
				return false;
			});
			$('#dialog_simple').dialog({
				autoOpen : false,
				width : 600,
				resizable : false,
				modal : false,
				title : "选择筛选条件",
				buttons : [{
					html : "&nbsp; 下载成绩表",
					"class" : "btn btn-default",
					click : function() {
						var id=$('#quizid').val();
						if(id==-1)
							return;
						var department=$("#collegelist option:selected").val(); 
						var role=$("#rolelist option:selected").val();
						var year=$("#yearlist option:selected").val(); 
						var gradestype=$("#gradestype option:selected").val(); 
						window.location.href="CustomDownload?id="+id+"&department="+department+"&role="+role+"&year="+year+"&gradestype="+gradestype;
					}
				}, {
					html : "&nbsp; 下载分组统计表",
					"class" : "btn btn-default",
					click : function() {
						var id=$('#quizid').val();
						if(id==-1)
							return;
						var groupcondition=$("#groupcondition option:selected").val(); 
						window.location.href="GroupDownload?id="+id+"&condition="+groupcondition;
					}
				}]
			});
			

		</script>
	</body>
</html>